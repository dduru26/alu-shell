#!/usr/bin/env bash
# This script handles both running an infinite loop and stopping it using pkill.
# It reacts to SIGTERM by printing "I am invincible!!!".

if [ "$1" == "start" ]; then
    # Terminal #0: Run the infinite loop process
    echo "Starting the 7-highlander process..."
    
    # Trap SIGTERM to display "I am invincible!!!"
    trap 'echo "I am invincible!!!"' SIGTERM

    while true; do
        echo "To infinity and beyond"
        sleep 2
    done

elif [ "$1" == "stop" ]; then
    # Terminal #1: Stop the running process using pkill.
    # `pkill` targets the script that runs the start option
    pkill -f "67-stop_me_if_you_can start" && echo "OK" || echo "7-highlander not running"
else
    echo "Usage: $0 {start|stop}"
fi
